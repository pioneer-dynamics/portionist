import{_ as C}from"./ActionSection-DS0r-X_G.js";import{k,o as l,e as c,l as B,v as N,a as r,r as V,f as v,t as x,T as w,s as T,Q as g,c as S,w as b,i as h,F as y,b as U,u as $,h as F}from"./app-C_UjF32i.js";import{_ as M}from"./InputLabel-CfdvJ3gD.js";import"./SectionTitle-BLzu9csX.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const A={class:"inline-flex items-center cursor-pointer"},D=["id","name","value"],L={class:"ms-3 text-sm font-medium text-gray-900 dark:text-gray-300"},E={__name:"Toggle",props:{label:String,value:{type:String,default:null},checked:{type:[Array,Boolean],default:!1},id:{type:String,default:null},name:{type:String,default:null}},emits:["update:checked"],setup(u,{emit:p}){const f=p,i=u,n=k({get(){return i.checked},set(d){f("update:checked",d)}});return(d,s)=>(l(),c("label",A,[B(r("input",{type:"checkbox",id:u.id,name:u.name,"onUpdate:modelValue":s[0]||(s[0]=m=>n.value=m),value:u.value,class:"sr-only peer"},null,8,D),[[N,n.value]]),s[1]||(s[1]=r("div",{class:"relative w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-branding-blue-400 dark:peer-focus:ring-branding-blue-400 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-600 peer-checked:bg-branding-blue-400"},null,-1)),r("span",L,[V(d.$slots,"default",{},()=>[v(x(u.label),1)])])]))}},Q={class:"relative overflow-x-auto shadow-md sm:rounded-lg"},Z={class:"w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400"},j={class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},q={scope:"row",class:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white"},K={__name:"NotificationSubscriptions",setup(u){const p=w({subscriptions:{}}),f=w({}),i=k(()=>[...new Set(g().props.config.notifications.items.map(e=>e.channels).flat())]),n=k(()=>[...new Set(g().props.config.notifications.items.flat())]),d=e=>e!=null&&e.label?e.label:e.class.split("\\").pop().replace(/([A-Z])/g," $1").trim(),s=e=>e.class.split("\\").pop();T(()=>{for(const t in n.value){var e=g().props.auth.user.notification_subscriptions.filter(a=>a.type==n.value[t].class&&a.unsubscribed_at==null).map(a=>a.channel=="*"?i.value.flat():a.channel).flat(),o=g().props.auth.user.notification_subscriptions.filter(a=>a.type==n.value[t].class).flat().length==0;p.subscriptions[s(n.value[t])]=o?i.value:e}});const m=e=>{f.transform(o=>({notification:e.class,channels:p.subscriptions[s(e)]})).post(route("notification-subscriptions"),{preserveScroll:!0,onSuccess:()=>{console.log("success")}})};return(e,o)=>(l(),S(C,null,{title:b(()=>o[0]||(o[0]=[v("Subscriptions")])),description:b(()=>[v("Manage notifications and emails sent from "+x(e.$page.props.config.app.name)+".",1)]),content:b(()=>[r("div",Q,[r("table",Z,[r("thead",j,[r("tr",null,[o[1]||(o[1]=r("th",{scope:"col",class:"px-6 py-3"}," Type ",-1)),(l(!0),c(y,null,h(i.value,t=>(l(),c("th",{key:"channel-"+t,scope:"col",class:"px-6 py-3"},x(t.toUpperCase()),1))),128))])]),r("tbody",null,[(l(!0),c(y,null,h(e.$page.props.config.notifications.items,t=>(l(),c("tr",{key:t.class,class:"odd:bg-white odd:dark:bg-gray-900 even:bg-gray-50 even:dark:bg-gray-800 border-b dark:border-gray-700"},[r("th",q,[U(M,{value:d(t),for:s(t)},null,8,["value","for"])]),(l(!0),c(y,null,h(i.value,a=>(l(),c("td",{class:"px-6 py-4",key:"subscription-"+a},[t.channels.includes(a)?(l(),S(E,{key:0,name:s(t),id:s(t),checked:$(p).subscriptions[s(t)],"onUpdate:checked":_=>$(p).subscriptions[s(t)]=_,onChange:_=>m(t),value:a},null,8,["name","id","checked","onUpdate:checked","onChange","value"])):F("",!0)]))),128))]))),128))])])])]),_:1}))}};export{K as default};
