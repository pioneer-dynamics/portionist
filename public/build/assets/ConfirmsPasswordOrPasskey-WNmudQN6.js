import{d as f,z as v,o as $,e as h,a as _,r as b,b as a,w as r,f as n,t as p,q as P,n as V,m as x}from"./app-C_UjF32i.js";import{a as S}from"./DialogModal-B9ELIoUM.js";import{_ as B}from"./InputError-BAxX15ZE.js";import{_ as N}from"./PrimaryButton-BwILkdv2.js";import{_ as T}from"./SecondaryButton-Bvjv9NQ1.js";import{_ as z}from"./TextInput-Bt2CpAG3.js";import{_ as F}from"./ConfirmsPasskey-CPMXb5_J.js";const I={class:"mt-4"},U={__name:"ConfirmsPasswordOrPasskey",props:{title:{type:String,default:"Confirm Authority"},content:{type:String,default:"For your security, please confirm your authority to continue."},button:{type:String,default:"Confirm"},mandatory:{type:Boolean,default:!1},seconds:{type:Number,default:0}},emits:["confirmed"],setup(t,{emit:g}){const i=g,l=t,m=f(!1),u=f(null),s=v({password:"",error:"",processing:!1}),c=f(null),C=()=>{m.value=!0,setTimeout(()=>c.value.focus(),250)},k=()=>{axios.get(route("password.confirmation",l.seconds>0?{seconds:l.seconds}:{})).then(e=>{e.data.confirmed&&!l.mandatory?i("confirmed"):u.value.start()})},w=()=>{s.processing=!0,axios.post(route("password.confirm"),{password:s.password}).then(()=>{s.processing=!1,d(),x().then(()=>i("confirmed"))}).catch(e=>{s.processing=!1,s.error=e.response.data.errors.password[0],c.value.focus()})},d=()=>{m.value=!1,s.password="",s.error=""};return(e,o)=>($(),h("span",null,[_("span",{onClick:k},[b(e.$slots,"default")]),a(F,{email:e.$page.props.auth.user.email,ref_key:"passkeyConfirmation",ref:u,onConfirmed:o[0]||(o[0]=y=>i("confirmed")),onCancelled:C},null,8,["email"]),a(S,{show:m.value,onClose:d,ref:"password"},{title:r(()=>[n(p(t.title),1)]),content:r(()=>[n(p(t.content)+" ",1),_("div",I,[a(z,{ref_key:"passwordInput",ref:c,modelValue:s.password,"onUpdate:modelValue":o[1]||(o[1]=y=>s.password=y),type:"password",class:"mt-1 block w-3/4",placeholder:"Password",autocomplete:"current-password",onKeyup:P(w,["enter"])},null,8,["modelValue"]),a(B,{message:s.error,class:"mt-2"},null,8,["message"])])]),footer:r(()=>[a(T,{onClick:d},{default:r(()=>o[2]||(o[2]=[n(" Cancel ")])),_:1}),a(N,{class:V(["ms-3",{"opacity-25":s.processing}]),disabled:s.processing,onClick:w},{default:r(()=>[n(p(t.button),1)]),_:1},8,["class","disabled"])]),_:1},8,["show"])]))}};export{U as _};
