import{b as y,a as d}from"./index-DHE1l8mP.js";import{d as p,T as v,Q as l}from"./app-CgsIz9cD.js";const g={__name:"ConfirmsPasskey",props:{remember:{type:Boolean,default:!1},title:{type:String,default:"Confirm Passkey"},content:{type:String,default:"For your security, please confirm your passkey to continue."},email:{type:String,default:""},mode:{type:String,default:"verify",validate:a=>["login","verify"].indexOf(a)!==-1}},emits:["confirmed","cancelled"],setup(a,{expose:c,emit:u}){const n=u,i=p(!1),t=p(null),o=a,s=v({passkey:"",email:o.email,remember:!1}),f=(e=!1)=>{n("cancelled",e),i.value=!1},m=()=>{d(JSON.parse(JSON.stringify(l().props.jetstream.flash.options))).then(e=>{s.passkey=e,s.transform(r=>({...r,remember:o.remember?"on":""})).post(route(o.mode=="login"?"passkeys.login":"passkeys.verify"),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{(o.mode=="login"||l().props.jetstream.flash.verified)&&(t.value=!0)},onError:r=>{console.error(r),t.value=!1}})}).catch(e=>{console.log(e),t.value=!1})};return c({passkeyForm:s,start:(e=null)=>{y()||n("cancelled"),e&&(s.email=e),s.post(route("passkeys.authentication-options"),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{l().props.jetstream.flash.options?(t.value=null,i.value=!0,m()):n("cancelled")},onError:r=>{f(!0)}})}}),(e,r)=>null}};export{g as _};
