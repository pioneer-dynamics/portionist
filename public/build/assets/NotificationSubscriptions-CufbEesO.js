import{_ as C}from"./ActionSection-D43bbZhl.js";import{k as v,o as l,e as c,l as B,v as N,a as r,r as T,g as x,t as f,T as w,s as U,Q as g,c as S,w as h,h as y,F as k,u as $,f as V}from"./app-D7ZV_jdG.js";import"./SectionTitle-Cb87fnKE.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const F={class:"inline-flex items-center cursor-pointer"},M=["value"],A={class:"ms-3 text-sm font-medium text-gray-900 dark:text-gray-300"},D={__name:"Toggle",props:{label:String,value:{type:String,default:null},checked:{type:[Array,Boolean],default:!1}},emits:["update:checked"],setup(d,{emit:u}){const b=u,p=d,o=v({get(){return p.checked},set(i){b("update:checked",i)}});return(i,a)=>(l(),c("label",F,[B(r("input",{type:"checkbox","onUpdate:modelValue":a[0]||(a[0]=m=>o.value=m),value:d.value,class:"sr-only peer"},null,8,M),[[N,o.value]]),a[1]||(a[1]=r("div",{class:"relative w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-branding-blue-400 dark:peer-focus:ring-branding-blue-400 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-600 peer-checked:bg-branding-blue-400"},null,-1)),r("span",A,[T(i.$slots,"default",{},()=>[x(f(d.label),1)])])]))}},L={class:"relative overflow-x-auto shadow-md sm:rounded-lg"},E={class:"w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400"},Q={class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},Z={scope:"row",class:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white"},H={__name:"NotificationSubscriptions",setup(d){const u=w({subscriptions:{}}),b=w({}),p=v(()=>[...new Set(g().props.config.notifications.items.map(e=>e.channels).flat())]),o=v(()=>[...new Set(g().props.config.notifications.items.flat())]),i=e=>e!=null&&e.label?e.label:e.class.split("\\").pop().replace(/([A-Z])/g," $1").trim(),a=e=>e.class.split("\\").pop();U(()=>{for(const t in o.value){var e=g().props.auth.user.notification_subscriptions.filter(s=>s.type==o.value[t].class&&s.unsubscribed_at==null).map(s=>s.channel=="*"?p.value.flat():s.channel).flat(),n=g().props.auth.user.notification_subscriptions.filter(s=>s.type==o.value[t].class).flat().length==0;u.subscriptions[a(o.value[t])]=n?p.value:e}});const m=e=>{b.transform(n=>({notification:e.class,channels:u.subscriptions[a(e)]})).post(route("notification-subscriptions"),{preserveScroll:!0,onSuccess:()=>{console.log("success")}})};return(e,n)=>(l(),S(C,null,{title:h(()=>n[0]||(n[0]=[x("Subscriptions")])),description:h(()=>[x("Manage notifications and emails sent from "+f(e.$page.props.config.app.name)+".",1)]),content:h(()=>[r("div",L,[r("table",E,[r("thead",Q,[r("tr",null,[n[1]||(n[1]=r("th",{scope:"col",class:"px-6 py-3"}," Type ",-1)),(l(!0),c(k,null,y(p.value,t=>(l(),c("th",{key:"channel-"+t,scope:"col",class:"px-6 py-3"},f(t.toUpperCase()),1))),128))])]),r("tbody",null,[(l(!0),c(k,null,y(e.$page.props.config.notifications.items,t=>(l(),c("tr",{key:t.class,class:"odd:bg-white odd:dark:bg-gray-900 even:bg-gray-50 even:dark:bg-gray-800 border-b dark:border-gray-700"},[r("th",Z,f(i(t)),1),(l(!0),c(k,null,y(p.value,s=>(l(),c("td",{class:"px-6 py-4",key:"subscription-"+s},[t.channels.includes(s)?(l(),S(D,{key:0,checked:$(u).subscriptions[a(t)],"onUpdate:checked":_=>$(u).subscriptions[a(t)]=_,onChange:_=>m(t),value:s},null,8,["checked","onUpdate:checked","onChange","value"])):V("",!0)]))),128))]))),128))])])])]),_:1}))}};export{H as default};
